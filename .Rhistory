setwd("~/working_paper/rbci/")
getwd()
library(dplyr)
select <- dplyr::select
library(magrittr)
library(data.table)
library(sf)
library(terra)
library(haven)
corr <- read_dta("C:/Users/Redha CHABA/Desktop/temp/outcomes.dta")
spl <- df%>%filter(spl==1)%>%distinct(iso)%>%pull(iso)
cty <- c("Benin", "Burkina Faso", "Cameroon", "Ghana", "Guinea", "Kenya", "Liberia", "Malawi", "Mozambique", "Namibia", "Niger", "Nigeria", "Sierra Leone", "Tanzania", "Uganda", "Zambia", "Zimbabwe")
corr%<>%
filter(Country%in%cty)%>%
select(Country, Year, corruption, corruption_gici, democracy_index, checks_balances_index, polyarchy, polity_score, voice_account, ex_corruption, accountability, control_corruption, gov_effective, reg_quality, rule_law)
View(corr)
corr%<>%
mutate(round = case_when(
between(Year, 2011, 2013) ~ 5,
between(Year, 2014, 2015) ~ 6,
between(Year, 2016, 2018) ~ 7,
between(Year, 2019, 2020) ~ 8,
TRUE ~ NA_integer_
))
corr %<>%
group_by(Country, round) %>%
filter(!is.na(round)) %>%
mutate(
corruption_mean = ifelse(all(is.na(corruption)), NA_real_, mean(corruption, na.rm = TRUE)),
corruption_gici_mean = ifelse(all(is.na(corruption_gici)), NA_real_, mean(corruption_gici, na.rm = TRUE)),
democracy_index_mean = ifelse(all(is.na(democracy_index)), NA_real_, mean(democracy_index, na.rm = TRUE)),
checks_balances_index_mean = ifelse(all(is.na(checks_balances_index)), NA_real_, mean(checks_balances_index, na.rm = TRUE)),
polyarchy_mean = ifelse(all(is.na(polyarchy)), NA_real_, mean(polyarchy, na.rm = TRUE)),
polity_score_mean = ifelse(all(is.na(polity_score)), NA_real_, mean(polity_score, na.rm = TRUE)),
voice_account_mean = ifelse(all(is.na(voice_account)), NA_real_, mean(voice_account, na.rm = TRUE)),
ex_corruption_mean = ifelse(all(is.na(ex_corruption)), NA_real_, mean(ex_corruption, na.rm = TRUE)),
accountability_mean = ifelse(all(is.na(accountability)), NA_real_, mean(accountability, na.rm = TRUE)),
control_corruption_mean = ifelse(all(is.na(control_corruption)), NA_real_, mean(control_corruption, na.rm = TRUE)),
gov_effective_mean = ifelse(all(is.na(gov_effective)), NA_real_, mean(gov_effective, na.rm = TRUE)),
reg_quality_mean = ifelse(all(is.na(reg_quality)), NA_real_, mean(reg_quality, na.rm = TRUE)),
rule_law_mean = ifelse(all(is.na(rule_law)), NA_real_, mean(rule_law, na.rm = TRUE)),
) %>%
ungroup()
corr %<>%
mutate(
corruption_median = ifelse(all(is.na(corruption_mean)), NA_integer_, median(corruption_mean, na.rm = TRUE)),
corruption_gici_median = ifelse(all(is.na(corruption_gici_mean)), NA_integer_, median(corruption_gici_mean, na.rm = TRUE)),
democracy_index_median = ifelse(all(is.na(democracy_index_mean)), NA_integer_, median(democracy_index_mean, na.rm = TRUE)),
checks_balances_index_median = ifelse(all(is.na(checks_balances_index_mean)), NA_integer_, median(checks_balances_index_mean, na.rm = TRUE)),
polyarchy_median = ifelse(all(is.na(polyarchy_mean)), NA_integer_, median(polyarchy_mean, na.rm = TRUE)),
polity_score_median = ifelse(all(is.na(polity_score_mean)), NA_integer_, median(polity_score_mean, na.rm = TRUE)),
voice_account_median = ifelse(all(is.na(voice_account_mean)), NA_integer_, median(voice_account_mean, na.rm = TRUE)),
ex_corruption_median = ifelse(all(is.na(ex_corruption_mean)), NA_integer_, median(ex_corruption_mean, na.rm = TRUE)),
accountability_median = ifelse(all(is.na(accountability_mean)), NA_integer_, median(accountability_mean, na.rm = TRUE)),
control_corruption_median = ifelse(all(is.na(control_corruption_mean)), NA_integer_, median(control_corruption_mean, na.rm = TRUE)),
gov_effective_median = ifelse(all(is.na(gov_effective_mean)), NA_integer_, median(gov_effective_mean, na.rm = TRUE)),
reg_quality_median = ifelse(all(is.na(reg_quality_mean)), NA_integer_, median(reg_quality_mean, na.rm = TRUE)),
rule_law_median = ifelse(all(is.na(rule_law_mean)), NA_integer_, median(rule_law_mean, na.rm = TRUE)),
) %>%
ungroup()
df %<>%
mutate(
corruption_median = ifelse(all(is.na(corruption_mean)), NA_integer_, median(corruption_mean, na.rm = TRUE)),
corruption_gici_median = ifelse(all(is.na(corruption_gici_mean)), NA_integer_, median(corruption_gici_mean, na.rm = TRUE)),
democracy_index_median = ifelse(all(is.na(democracy_index_mean)), NA_integer_, median(democracy_index_mean, na.rm = TRUE)),
checks_balances_index_median = ifelse(all(is.na(checks_balances_index_mean)), NA_integer_, median(checks_balances_index_mean, na.rm = TRUE)),
polyarchy_median = ifelse(all(is.na(polyarchy_mean)), NA_integer_, median(polyarchy_mean, na.rm = TRUE)),
polity_score_median = ifelse(all(is.na(polity_score_mean)), NA_integer_, median(polity_score_mean, na.rm = TRUE)),
voice_account_median = ifelse(all(is.na(voice_account_mean)), NA_integer_, median(voice_account_mean, na.rm = TRUE)),
ex_corruption_median = ifelse(all(is.na(ex_corruption_mean)), NA_integer_, median(ex_corruption_mean, na.rm = TRUE)),
accountability_median = ifelse(all(is.na(accountability_mean)), NA_integer_, median(accountability_mean, na.rm = TRUE)),
control_corruption_median = ifelse(all(is.na(control_corruption_mean)), NA_integer_, median(control_corruption_mean, na.rm = TRUE)),
gov_effective_median = ifelse(all(is.na(gov_effective_mean)), NA_integer_, median(gov_effective_mean, na.rm = TRUE)),
reg_quality_median = ifelse(all(is.na(reg_quality_mean)), NA_integer_, median(reg_quality_mean, na.rm = TRUE)),
rule_law_median = ifelse(all(is.na(rule_law_mean)), NA_integer_, median(rule_law_mean, na.rm = TRUE)),
rsf_index_median = ifelse(all(is.na(rsf_index_mean)), NA_integer_, median(rsf_index_mean, na.rm = TRUE)),
) %>%
ungroup()
View(corr)
setwd("~/working_paper/rbci/")
getwd()
library(dplyr)
select <- dplyr::select
library(magrittr)
library(data.table)
library(sf)
library(terra)
library(haven)
getwd()
excel_sheets("/data/data_raw/corruption/CPI2024-Results-and-trends.xlsx")
library(readxl)
excel_sheets("/data/data_raw/corruption/CPI2024-Results-and-trends.xlsx")
getwd()
excel_sheets("data/data_raw/corruption/CPI2024-Results-and-trends.xlsx")
cpi <- read_excel("CPI2024-Results-and-trends.xlsx", sheet = "CPI Historical")
cpi <- read_excel("data/data_raw/corruption/CPI2024-Results-and-trends.xlsx", sheet = "CPI Historical")
View(cpi)
cpi <- read_excel("data/data_raw/corruption/CPI2024-Results-and-trends.xlsx", sheet = "CPI Historical", skip = 1)
View(cpi)
cty <- c("Benin", "Burkina Faso", "Cameroon", "Ghana", "Guinea", "Kenya", "Liberia", "Malawi", "Mozambique", "Namibia", "Niger", "Nigeria", "Sierra Leone", "Tanzania", "Uganda", "Zambia", "Zimbabwe")
View(cpi)
cpi%<>%
filter(`Country / Territory`%in%cty)
View(cpi)
cpi%<>%
rename(iso=`Country / Territory`)
View(cpi)
cpi <- read_excel("data/data_raw/corruption/CPI2024-Results-and-trends.xlsx", sheet = "CPI Historical", skip = 1)
cty <- c("Benin", "Burkina Faso", "Cameroon", "Ghana", "Guinea", "Kenya", "Liberia", "Malawi", "Mozambique", "Namibia", "Niger", "Nigeria", "Sierra Leone", "Tanzania", "Uganda", "Zambia", "Zimbabwe")
cpi%<>%
filter(`Country / Territory`%in%cty)
cpi%<>%
rename(cname=`Country / Territory`)
cpi <- read_excel("data/data_raw/corruption/CPI2024-Results-and-trends.xlsx", sheet = "CPI Historical", skip = 1)
cpi%<>%
rename(cname=`Country / Territory`)
cty <- c("Benin", "Burkina Faso", "Cameroon", "Ghana", "Guinea", "Kenya", "Liberia", "Malawi", "Mozambique", "Namibia", "Niger", "Nigeria", "Sierra Leone", "Tanzania", "Uganda", "Zambia", "Zimbabwe")
cpi%<>%
filter(cname%in%cty)
cpi%>%pull(distinct(cname))
cpi%>%distinct(cname)%>%
pull(cname)
View(cpi)
cpi%>%
glimpse()
cpi%<>%
mutate(round = case_when(
between(Year, 2011, 2013) ~ 5,
between(Year, 2014, 2015) ~ 6,
between(Year, 2016, 2018) ~ 7,
between(Year, 2019, 2020) ~ 8,
TRUE ~ NA_integer_
))
View(cpi)
cpi %<>%
group_by(cname, round) %>%
filter(!is.na(round)) %>%
mutate(
cpi_mean = ifelse(all(is.na(cpi)), NA_real_, mean(cpi, na.rm = TRUE))) %>%
ungroup()
View(cpi)
cpi %<>%
group_by(cname, round) %>%
filter(!is.na(round)) %>%
mutate(
cpi_mean = ifelse(all(is.na(`CPI score`)), NA_real_, mean(`CPI score`, na.rm = TRUE))) %>%
ungroup()
View(cpi)
cpi %<>%
mutate(
cpi_median = ifelse(all(is.na(cpi_mean)), NA_integer_, median(cpi_mean, na.rm = TRUE))) %>%
ungroup()
View(cpi)
cpi%<>%
group_by(round)%>%
mutate(
cpi_median_r = ifelse(all(is.na(cpi_mean)), NA_integer_, median(cpi_mean, na.rm = TRUE)))%>%
ungroup()
View(cpi)
cpi%>%
glimpse()
cpi%<>%
select(ISO3, cpi_mean, cpi_median, cpi_median_r)
cpi%<>%
rename(iso=ISO3)
cpi%>%
glimpse()
cpi%<>%
distinct(iso, round, .keep_all = TRUE)
library(readxl)
excel_sheets("data/data_raw/corruption/CPI2024-Results-and-trends.xlsx")
cpi <- read_excel("data/data_raw/corruption/CPI2024-Results-and-trends.xlsx", sheet = "CPI Historical", skip = 1)
cpi%<>%
rename(cname=`Country / Territory`)
cty <- c("Benin", "Burkina Faso", "Cameroon", "Ghana", "Guinea", "Kenya", "Liberia", "Malawi", "Mozambique", "Namibia", "Niger", "Nigeria", "Sierra Leone", "Tanzania", "Uganda", "Zambia", "Zimbabwe")
cpi%<>%
filter(cname%in%cty)
cpi%<>%
mutate(round = case_when(
between(Year, 2011, 2013) ~ 5,
between(Year, 2014, 2015) ~ 6,
between(Year, 2016, 2018) ~ 7,
between(Year, 2019, 2020) ~ 8,
TRUE ~ NA_integer_
))
cpi %<>%
group_by(cname, round) %>%
filter(!is.na(round)) %>%
mutate(
cpi_mean = ifelse(all(is.na(`CPI score`)), NA_real_, mean(`CPI score`, na.rm = TRUE))) %>%
ungroup()
cpi %<>%
mutate(
cpi_median = ifelse(all(is.na(cpi_mean)), NA_integer_, median(cpi_mean, na.rm = TRUE))) %>%
ungroup()
cpi%<>%
group_by(round)%>%
mutate(
cpi_median_r = ifelse(all(is.na(cpi_mean)), NA_integer_, median(cpi_mean, na.rm = TRUE)))%>%
ungroup()
cpi%<>%
select(ISO3, round, cpi_mean, cpi_median, cpi_median_r)
cpi%<>%
rename(iso=ISO3)
cpi%<>%
distinct(iso, round, .keep_all = TRUE)
View(cpi)
df <- readRDS("data/data_rds/df_region.rds")
df%<>%
left_join(cpi, by = c("iso", "round"))
View(df)
saveRDS(df, file = "data/data_rds/df_region.rds")
write_dta(df, "data/data_dta/df_region.dta")
library(readxl)
excel_sheets("data/data_raw/corruption/CPI2024-Results-and-trends.xlsx")
cpi <- read_excel("data/data_raw/corruption/CPI2024-Results-and-trends.xlsx", sheet = "CPI Historical", skip = 1)
library(readxl)
excel_sheets("data/data_raw/corruption/CPI2024-Results-and-trends.xlsx")
cpi <- read_excel("data/data_raw/corruption/CPI2024-Results-and-trends.xlsx", sheet = "CPI Historical", skip = 1)
cpi%<>%
rename(iso=ISO3)
cty <- c("BEN", "BFA", "CMR", "GIN", "LBR", "NAM", "NER", "SLE", "GHA","KEN","MOZ", "MWI","NGA","TZA","UGA","ZMB", "ZWE")
cpi%<>%
filter(iso%in%cty)
cpi%<>%
mutate(round = case_when(
between(Year, 2011, 2013) ~ 5,
between(Year, 2014, 2015) ~ 6,
between(Year, 2016, 2018) ~ 7,
between(Year, 2019, 2020) ~ 8,
TRUE ~ NA_integer_
))
library(readxl)
excel_sheets("data/data_raw/corruption/CPI2024-Results-and-trends.xlsx")
cpi <- read_excel("data/data_raw/corruption/CPI2024-Results-and-trends.xlsx", sheet = "CPI Historical", skip = 1)
cpi%<>%
rename(iso=ISO3)
cty <- c("BEN", "BFA", "CMR", "GIN", "LBR", "NAM", "NER", "SLE", "GHA","KEN","MOZ", "MWI","NGA","TZA","UGA","ZMB", "ZWE")
cpi%<>%
filter(iso%in%cty)
cpi%<>%
mutate(round = case_when(
between(Year, 2011, 2013) ~ 5,
between(Year, 2014, 2015) ~ 6,
between(Year, 2016, 2018) ~ 7,
between(Year, 2019, 2020) ~ 8,
TRUE ~ NA_integer_
))
cpi %<>%
group_by(cname, round) %>%
filter(!is.na(round)) %>%
mutate(
cpi_mean = ifelse(all(is.na(`CPI score`)), NA_real_, mean(`CPI score`, na.rm = TRUE))) %>%
ungroup()%>%
mutate(
cpi_median = ifelse(all(is.na(cpi_mean)), NA_integer_, median(cpi_mean, na.rm = TRUE))) %>%
ungroup()%>%
group_by(round)%>%
mutate(
cpi_median_r = ifelse(all(is.na(cpi_mean)), NA_integer_, median(cpi_mean, na.rm = TRUE)))%>%
ungroup()
cpi%<>%
select(iso, round, cpi_mean, cpi_median, cpi_median_r)%>%
distinct(iso, round, .keep_all = TRUE)
library(readxl)
excel_sheets("data/data_raw/corruption/CPI2024-Results-and-trends.xlsx")
cpi <- read_excel("data/data_raw/corruption/CPI2024-Results-and-trends.xlsx", sheet = "CPI Historical", skip = 1)
cpi%<>%
rename(iso=ISO3)
cty <- c("BEN", "BFA", "CMR", "GIN", "LBR", "NAM", "NER", "SLE", "GHA","KEN","MOZ", "MWI","NGA","TZA","UGA","ZMB", "ZWE")
cpi%<>%
filter(iso%in%cty)
cpi%<>%
mutate(round = case_when(
between(Year, 2011, 2013) ~ 5,
between(Year, 2014, 2015) ~ 6,
between(Year, 2016, 2018) ~ 7,
between(Year, 2019, 2020) ~ 8,
TRUE ~ NA_integer_
))
cpi %<>%
group_by(iso, round) %>%
filter(!is.na(round)) %>%
mutate(
cpi_mean = ifelse(all(is.na(`CPI score`)), NA_real_, mean(`CPI score`, na.rm = TRUE))) %>%
ungroup()%>%
mutate(
cpi_median = ifelse(all(is.na(cpi_mean)), NA_integer_, median(cpi_mean, na.rm = TRUE))) %>%
ungroup()%>%
group_by(round)%>%
mutate(
cpi_median_r = ifelse(all(is.na(cpi_mean)), NA_integer_, median(cpi_mean, na.rm = TRUE)))%>%
ungroup()
cpi%<>%
select(iso, round, cpi_mean, cpi_median, cpi_median_r)%>%
distinct(iso, round, .keep_all = TRUE)
df <- readRDS("data/data_rds/df_region.rds")
View(cpi)
